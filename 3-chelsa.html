<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Accessing the CHELSA-TraCE21k 1km climate timeseries with Quetzal-CRUMBS &mdash; Quetzal-CRUMBS  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/readthedocs-custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Species Distribution Modeling with Quetzal-CRUMBS" href="4-sdm.html" />
    <link rel="prev" title="Accessing the GBIF database with Quetzal-CRUMBS" href="2-gbif.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html">
            <img src="_static/quetzal-crumbs-fa-white-title.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Welcome</a></li>
<li class="toctree-l1"><a class="reference internal" href="1-nest.html">1. Enter the Quetzal-NEST</a></li>
<li class="toctree-l1"><a class="reference internal" href="2-gbif.html">2. Get GBIF presence records</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">3. Get CHELSA climate data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#why-do-we-need-chelsa">Why do we need CHELSA?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#usage">Usage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="#command">Command</a></li>
<li class="toctree-l3"><a class="reference internal" href="#behavior">Behavior</a></li>
<li class="toctree-l3"><a class="reference internal" href="#output">Output</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="4-sdm.html">4. Landscape habitability reconstruction</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">5. Prepare the landscape</a></li>
<li class="toctree-l1"><a class="reference internal" href="_autosummary/crumbs.html">API reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Quetzal-CRUMBS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Accessing the CHELSA-TraCE21k 1km climate timeseries with Quetzal-CRUMBS</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="accessing-the-chelsa-trace21k-1km-climate-timeseries-with-quetzal-crumbs">
<h1>Accessing the CHELSA-TraCE21k 1km climate timeseries with Quetzal-CRUMBS<a class="headerlink" href="#accessing-the-chelsa-trace21k-1km-climate-timeseries-with-quetzal-crumbs" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="https://chelsa-climate.org/chelsa-trace21k/">CHELSA-TraCE21k</a> provides
monthly climate data for temperature and precipitation at 30 arcsec spatial
resolution in 100-yeartime steps for the last 21,000 years.
Based on the reconstructed paleo orography, mean annual
temperature and precipitation was downscaled using the CHELSA V1.2 algorithm (<a class="reference internal" href="#karger2021" id="id1"><span>[Karger2021]</span></a>).</p>
<section id="why-do-we-need-chelsa">
<h2>Why do we need CHELSA?<a class="headerlink" href="#why-do-we-need-chelsa" title="Permalink to this headline">¶</a></h2>
<p>At phylogeographic scales, climatic variations cause changes in sea-levels and orography,
and as a result have an important impact on the biodiversity, affecting species migration
patterns and ecology. Database with high spatial resolution are a necessity when
processes happening at a small spatial scale (<em>e.g., two masses of land that get disconnected
by a single small strait</em>) impact a species ecology (<em>e.g., isolation of population</em>)
and have a snowball effect on the downstream levels of biodiversity
at higher spatial scales (<em>e.g., emergence of two distinct species</em>).</p>
<figure class="align-center" id="id2">
<a class="with-shadow reference internal image-reference" href="_images/DEM_dynamic_2D.gif"><img alt="Digital Elevation Model" class="with-shadow" src="_images/DEM_dynamic_2D.gif" style="width: 400px;" /></a>
<figcaption>
<p><span class="caption-text">Effect of sea-level changes on islands biogeography</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>Models that can link these scales have to rely on high-resolution landscape data.
iDDC can integrate such data by fitting models of species distribution
on present climate and elevation, extrapolating them to past climates conditions and elevations
to reconstruct dynamic habitability landscapes.</p>
</section>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>Quetzal-CRUMBS SDM utilities will automatically download the CHELSA bioclimatic
and elevation files when they need to make them available to the classifiers:
you should not have to download them yourself when you are building
your iDDC workflow.</p>
<p>However, if you happen to download some CHELSA files for your own needs,
here is how to do so.</p>
<section id="context">
<h3>Context<a class="headerlink" href="#context" title="Permalink to this headline">¶</a></h3>
<p>You need a shapefile to define the longitude/latitude points to define the area
of the world of interest.
In iDDC wokflows, the points of interest would normally be the coordinates of your
DNA samples, but if you want to reproduce our example then just download our test
data points from Github:</p>
<ol class="arabic simple">
<li><p>Go to the <a class="reference external" href="https://download-directory.github.io/">Download Directory</a> utility</p></li>
<li><p>Enter this url: <code class="docutils literal notranslate"><span class="pre">https://github.com/Becheler/quetzal-CRUMBS/tree/main/tests/data/test_points</span></code></p></li>
<li><p>Press enter to start the download</p></li>
<li><p>Extract the archive in your working directory</p></li>
<li><p>You should find 3 files: move them to your Docker working directory</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">test_points.shp</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">test_points.shx</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">test_points.dbf</span></code></p></li>
</ul>
</li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>CHELSA-TraCE21k uses times identifiers that range from 20 (present century) to -200 (LGM).
Have a look <a class="reference external" href="https://chelsa-climate.org/chelsa-trace21k/">at their technical notice</a></p>
</div>
</section>
<section id="command">
<h3>Command<a class="headerlink" href="#command" title="Permalink to this headline">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">sample</span><span class="o">=</span><span class="s1">&#39;test_points/test_points.shp&#39;</span>
<span class="nv">buffer</span><span class="o">=</span><span class="m">2</span>.0                <span class="c1">#in degrees</span>
<span class="nv">biovars</span><span class="o">=</span>dem,bio01         <span class="c1">#or bio01,bio02,bio10,bio12, or simply dem,bio for all</span>
<span class="nv">chelsaTimes</span><span class="o">=</span><span class="m">20</span>,0,-20

crumbs-get-chelsa <span class="se">\</span>
     --variables <span class="nv">$biovars</span> <span class="se">\</span>
     --timesID <span class="nv">$chelsaTimes</span> <span class="se">\</span>
     --points <span class="nv">$sample</span> <span class="se">\</span>
     --buffer <span class="nv">$buffer</span> <span class="se">\</span>
     --cleanup
</pre></div>
</div>
</section>
<section id="behavior">
<h3>Behavior<a class="headerlink" href="#behavior" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><p>A world file is downloaded for the variable and time of interest in the <code class="docutils literal notranslate"><span class="pre">chelsa-world</span></code> folder</p></li>
<li><p>The file is cropped to the bounding box of the given geographic points (+/- a buffer in degrees)</p></li>
<li><p>The resulting landscape file is stored in a <code class="docutils literal notranslate"><span class="pre">chelsa-landscape</span></code> folder</p></li>
<li><p>The world file deleted if <code class="docutils literal notranslate"><span class="pre">--cleanup</span></code>, or kept if  <code class="docutils literal notranslate"><span class="pre">--no-cleanup</span></code>.</p></li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>These world files are heavy, and there are many many of them, so if you don’t need them, use <code class="docutils literal notranslate"><span class="pre">--cleanup</span></code>.</p>
</div>
</section>
<section id="output">
<h3>Output<a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>- Quetzal-CRUMBS - CHELSA-TraCE21k data access for iDDC modeling
    ... rasters will be cropped to bounding box infered from points: POLYGON ((128.8515 -18.2625, 139.0335 -18.2625, 139.0335 -9.0333, 128.8515 -9.0333, 128.8515 -18.2625))
https://os.zhdk.cloud.switch.ch/envicloud/chelsa/chelsa_V1/chelsa_trace/orog/CHELSA_TraCE21k_dem_19_V1.0.tif
    ... World file does not exist, starting download from scratch.
100% 252M/252M [00:17&lt;00:00, 14.7MiB/s]
https://os.zhdk.cloud.switch.ch/envicloud/chelsa/chelsa_V1/chelsa_trace/bio/CHELSA_TraCE21k_bio01_19_V1.0.tif
    ... World file does not exist, starting download from scratch.
100% 533M/533M [00:36&lt;00:00, 14.5MiB/s]
    ... Converting bands to VRT file: chelsa-stacked_dem.vrt
    ... Converting chelsa-stacked_dem.vrt to GeoTiff file: chelsa-stacked_dem.tif
    ... Converting bands to VRT file: chelsa-stacked_bio01.vrt
    ... Converting chelsa-stacked_bio01.vrt to GeoTiff file: chelsa-stacked_bio01.tif
</pre></div>
</div>
</section>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<dl class="citation">
<dt class="label" id="karger2021"><span class="brackets"><a class="fn-backref" href="#id1">Karger2021</a></span></dt>
<dd><p>Karger, D. N., Nobis, M. P., Normand, S., Graham, C. H., &amp; Zimmermann, N. E. (2021): CHELSA-TraCE21k v1. 0. Downscaled transient temperature and precipitation data since the last glacial maximum. Climate of the Past Discussions, 1-27.</p>
</dd>
</dl>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="2-gbif.html" class="btn btn-neutral float-left" title="Accessing the GBIF database with Quetzal-CRUMBS" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="4-sdm.html" class="btn btn-neutral float-right" title="Species Distribution Modeling with Quetzal-CRUMBS" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright © 2022 Arnaud Becheler &amp; L. Lacey Knowles.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>